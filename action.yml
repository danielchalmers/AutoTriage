name: "AutoTriage"
description: "AI issue & PR triage that reads context, drafts a plan, and applies it according to your project prompt."
author: "Daniel Chalmers"
branding:
  color: "blue"
  icon: "robot"

inputs:
  issue-number:
    description: "Single issue or PR number to triage; when omitted the GitHub event target is used."
    required: false
  issue-numbers:
    description: "Space or comma separated list of issue / PR numbers to triage explicitly, processed in the order provided."
    required: false
  prompt-path:
    description: "Repo-relative path to the prompt template that governs triage behavior (tone, rules, closure policy)."
    required: false
    default: ".github/AutoTriage.prompt"
  readme-path:
    description: "Path to an optional Markdown file (e.g., your README) that is bundled into the AI prompt for extra context."
    required: false
    default: "README.md"
  enabled:
    description: "Set to true to apply labels, comments, and title changes; false performs a dry run and logs the plan only."
    required: false
    default: "true"
  db-path:
    description: "Optional path to a JSON file that stores per-item history between runs."
    required: false
  model-fast:
    description: "Identifier of the fast analysis model used for the first pass (default shown below). Leave blank to skip the fast pass."
    required: false
    default: "gemini-2.5-flash"
  model-pro:
    description: "Identifier of the deeper review model used when the fast pass asks for confirmation."
    required: false
    default: "gemini-3-flash-preview"
  model-fast-temperature:
    description: "Sampling temperature for the fast model (0-2); lower keeps responses deterministic while higher explores alternatives."
    required: false
    default: "0.0"
  model-pro-temperature:
    description: "Sampling temperature for the pro model (0-2); Gemini 3 recommends 1.0 for optimal performance."
    required: false
    default: "1.0"
  max-timeline-events:
    description: "Maximum number of recent timeline events injected into the prompt context."
    required: false
    default: "40"
  max-fast-timeline-events:
    description: "Maximum timeline events included in the fast pass prompt."
    required: false
    default: "12"
  max-pro-timeline-events:
    description: "Maximum timeline events included in the pro pass prompt."
    required: false
    default: "40"
  max-fast-readme-chars:
    description: "Character cap for README context in the fast pass (0 disables README in fast)."
    required: false
    default: "0"
  max-pro-readme-chars:
    description: "Character cap for README context in the pro pass."
    required: false
    default: "120000"
  max-fast-issue-body-chars:
    description: "Character cap for issue/PR body text in the fast pass."
    required: false
    default: "4000"
  max-pro-issue-body-chars:
    description: "Character cap for issue/PR body text in the pro pass."
    required: false
    default: "20000"
  max-fast-comment-body-chars:
    description: "Character cap for timeline comment text in the fast pass."
    required: false
    default: "600"
  max-pro-comment-body-chars:
    description: "Character cap for timeline comment text in the pro pass."
    required: false
    default: "4000"
  max-fast-commit-message-chars:
    description: "Character cap for commit messages in the fast pass."
    required: false
    default: "300"
  max-pro-commit-message-chars:
    description: "Character cap for commit messages in the pro pass."
    required: false
    default: "2000"
  max-fast-review-text-chars:
    description: "Character cap for pull request review text in the fast pass."
    required: false
    default: "600"
  max-pro-review-text-chars:
    description: "Character cap for pull request review text in the pro pass."
    required: false
    default: "4000"
  max-fast-prior-thought-chars:
    description: "Character cap for prior run thoughts in the fast pass (0 disables carry-over thoughts)."
    required: false
    default: "0"
  max-pro-prior-thought-chars:
    description: "Character cap for prior run thoughts in the pro pass."
    required: false
    default: "8000"
  max-triages:
    description: "Cap on how many targets can escalate to the review pass during this run."
    required: false
    default: "20"
  max-fast-runs:
    description: "Cap on how many targets can be analyzed with the fast model during this run."
    required: false
    default: "100"
  additional-instructions:
    description: "Additional instructions appended to the prompt for testing or tweaking behavior without committing a new prompt."
    required: false
  context-caching:
    description: "Set to true to enable Gemini context caching, which reduces token usage when triaging multiple issues. Requires a paid Gemini plan."
    required: false
    default: "false"
  skip-unchanged:
    description: "Set to true to skip re-processing issues that are already in the database and haven't changed since the last run."
    required: false
    default: "false"
  strict-mode:
    description: "Set to true to fail the overall job if any runs have errors."
    required: false
    default: "false"

runs:
  using: "node24"
  main: "dist/index.js"
